(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"aR+y":function(t,e,r){"use strict";r.r(e);var s={props:{order:{type:Object,required:!0}},computed:{createdAt:function(){return this.order.created_at.substr(0,16).replace("T"," ")}}},n=r("KHd+"),a=Object(n.a)(s,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("table",{staticClass:"table table-sm is-headless mb-0 vertical-align-top"},[r("tr",[r("th",[t._v(t._s(t.__("ID"))+":")]),t._v(" "),r("td",[t._v("#"+t._s(t.order.id))])]),t._v(" "),r("tr",[r("th",[t._v(t._s(t.__("Date"))+":")]),t._v(" "),r("td",[t._v(t._s(t.createdAt))])]),t._v(" "),r("tr",[r("th",[t._v(t._s(t.__("Customer"))+":")]),t._v(" "),r("td",[t._v(t._s(t.order.address.name))])]),t._v(" "),r("tr",[r("th",[t._v(t._s(t.__("Tax"))+":")]),t._v(" "),r("td",[t._v(t._s(t.order.formatted_tax))])]),t._v(" "),r("tr",[r("th",[t._v(t._s(t.__("Shipping"))+":")]),t._v(" "),r("td",[t._v("\n            "+t._s(t.order.shipping.formatted_total)+"\n            ("+t._s(t.order.shipping.driver_name)+")\n        ")])]),t._v(" "),r("tr",[r("th",[t._v(t._s(t.__("Discount"))+":")]),t._v(" "),r("td",[t._v(t._s(t.order.formatted_discount))])]),t._v(" "),r("tr",[r("th",[t._v(t._s(t.__("Total"))+":")]),t._v(" "),r("td",[t._v(t._s(t.order.formatted_total))])]),t._v(" "),r("tr",[r("th",[t._v(t._s(t.__("Billing Address"))+":")]),t._v(" "),r("td",[r("address",[r("div",[t._v(t._s(t.order.address.name))]),t._v(" "),t.order.address.company?r("div",[t._v(t._s(t.order.address.company))]):t._e(),t._v(" "),r("div",[t._v(t._s(t.order.address.address))]),t._v(" "),t.order.address.address_second?r("div",[t._v(t._s(t.order.address.address_second))]):t._e(),t._v(" "),r("div",[t._v(t._s(t.order.address.postcode)+", "+t._s(t.order.address.city)+", "+t._s(t.order.address.state))]),t._v(" "),r("div",[t._v(t._s(t.order.address.country_name))]),t._v(" "),r("div",[t._v(t._s(t.order.address.phone))]),t._v(" "),r("div",[t._v(t._s(t.order.address.email))])])])]),t._v(" "),r("tr",[r("th",[t._v(t._s(t.__("Shipping Address"))+":")]),t._v(" "),r("td",[r("address",[r("div",[t._v(t._s(t.order.shipping.address.name))]),t._v(" "),t.order.shipping.address.company?r("div",[t._v(t._s(t.order.shipping.address.company))]):t._e(),t._v(" "),r("div",[t._v(t._s(t.order.shipping.address.address))]),t._v(" "),t.order.shipping.address.address_second?r("div",[t._v(t._s(t.order.shipping.address.address_second))]):t._e(),t._v(" "),r("div",[t._v("\n                    "+t._s(t.order.shipping.address.postcode)+",\n                    "+t._s(t.order.shipping.address.city)+",\n                    "+t._s(t.order.shipping.address.state)+"\n                ")]),t._v(" "),r("div",[t._v(t._s(t.order.shipping.address.country_name))]),t._v(" "),r("div",[t._v(t._s(t.order.shipping.address.phone))]),t._v(" "),r("div",[t._v(t._s(t.order.shipping.address.email))])])])])])}),[],!1,null,null,null).exports,o={props:{transaction:{type:Object,required:!0}},data:function(){return{busy:!1}},computed:{className:function(){return"text-"+("refund"===this.transaction.type?"danger":"success")},icon:function(){return this.completed?"retry":"done"},sign:function(){return"refund"===this.transaction.type?"-":"+"},amount:function(){return new Number(this.transaction.amount).toFixed(2)},completed:function(){return!!this.transaction.completed_at},action:function(){return"/bazar/orders/".concat(this.transaction.order_id,"/transactions/").concat(this.transaction.id)},completedAt:function(){return this.transaction.completed_at.substr(0,16).replace("T"," ")}},methods:{update:function(){var t=this;this.busy=!0,this.$http.patch(this.action).then((function(e){t.transaction.completed_at=t.completed?null:(new Date).toISOString()})).catch((function(t){})).finally((function(){t.busy=!1}))},destroy:function(){var t=this;this.busy=!0,this.$http.delete(this.action).then((function(e){t.$emit("delete")})).catch((function(t){})).finally((function(){t.busy=!1}))}}},d=Object(n.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("tr",[r("td",[r("span",{class:t.className},[t._v("\n            "+t._s(t.sign+" "+t.amount)+"\n        ")])]),t._v(" "),r("td",[r("span",[t._v(t._s(t.transaction.driver_name))]),t._v(" "),t.transaction.url?r("small",[t._v("\n            ("),r("a",{attrs:{href:t.transaction.url,target:"_blank"}},[t._v(t._s(t.transaction.key))]),t._v(")\n        ")]):t._e()]),t._v(" "),r("td",[t.transaction.completed_at?r("span",[t._v("\n            "+t._s(t.completedAt)+"\n        ")]):r("span",{staticClass:"badge badge-warning"},[t._v(t._s(t.__("Pending")))])]),t._v(" "),r("td",[r("div",{staticClass:"d-flex"},[r("button",{staticClass:"icon-btn",class:{"icon-btn-success":!t.completed,"icon-btn-warning":t.completed},attrs:{type:"button",disabled:t.busy,"aria-label":t.completed?t.__("Mark pending"):t.__("Mark completed")},on:{click:function(e){return e.preventDefault(),t.update(e)}}},[r("icon",{attrs:{icon:t.icon}})],1),t._v(" "),r("button",{staticClass:"icon-btn icon-btn-danger ml-1",attrs:{type:"button",disabled:t.busy,"aria-label":t.__("Delete transaction")},on:{click:function(e){return e.preventDefault(),t.destroy(e)}}},[r("icon",{attrs:{icon:"close"}})],1)])])])}),[],!1,null,null,null).exports;var i={props:{order:{type:Object,reqired:!0}},watch:{"model.type":function(t,e){"payment"===t&&(this.model.driver="manual")}},data:function(){return{model:{amount:null,type:"refund",driver:"manual"}}},computed:{action:function(){return"/bazar/orders/".concat(this.order.id,"/transactions")},types:function(){return{payment:this.__("Payment"),refund:this.__("Refund")}},drivers:function(){var t={manual:this.__("Manual")};return"refund"===this.model.type?this.order.transactions.reduce((function(t,e){return Object.assign(t,(r={},s=e.driver,n=e.driver_name,s in r?Object.defineProperty(r,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[s]=n,r));var r,s,n}),t):t}},methods:{add:function(t){this.order.transactions.push(t),this.$refs.refund.close(),this.model={amount:null,type:"refund",driver:"manual"},this.$refs.form.reset()}}},_={components:{Transaction:d,CreateTransaction:Object(n.a)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("data-form",{ref:"form",attrs:{json:"",action:t.action,model:t.model},on:{success:t.add},scopedSlots:t._u([{key:"default",fn:function(e){return[r("button",{staticClass:"btn btn-sm btn-primary",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.$refs.refund.open(e)}}},[t._v("\n            "+t._s(t.__("Create Transaction"))+"\n        ")]),t._v(" "),r("modal",{ref:"refund",attrs:{title:t.__("Create Transaction")},scopedSlots:t._u([{key:"default",fn:function(){return[e.errors.any()?r("alert",{attrs:{type:"danger",closable:""}},[t._v("\n                    "+t._s(t.__("Something went wrong!"))+"\n                ")]):t._e(),t._v(" "),r("form-select",{attrs:{name:"type",label:t.__("Type"),options:t.types},model:{value:e.fields.type,callback:function(r){t.$set(e.fields,"type",r)},expression:"form.fields.type"}}),t._v(" "),r("form-select",{attrs:{name:"driver",label:t.__("Driver"),options:t.drivers},model:{value:e.fields.driver,callback:function(r){t.$set(e.fields,"driver",r)},expression:"form.fields.driver"}}),t._v(" "),r("form-input",{attrs:{name:"amount",type:"number",min:"0",step:"0.01",label:t.__("Amount (:CURRENCY)",{currency:t.order.currency}),help:t.__("Leave it empty to apply the remaining amount automatically.")},model:{value:e.fields.amount,callback:function(r){t.$set(e.fields,"amount",r)},expression:"form.fields.amount"}})]},proxy:!0},{key:"footer",fn:function(s){return[r("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.busy}},[t._v("\n                    "+t._s(t.__("Create"))+"\n                ")]),t._v(" "),r("button",{staticClass:"btn btn-outline-primary",attrs:{type:"button",disabled:e.busy},on:{click:function(t){return t.preventDefault(),s.close(t)}}},[t._v("\n                    "+t._s(t.__("Cancel"))+"\n                ")])]}}],null,!0)})]}}])})}),[],!1,null,null,null).exports},props:{order:{type:Object,required:!0}},data:function(){return{model:this.order}},methods:{remove:function(t){this.model.transactions.splice(t,1)}}},c=Object(n.a)(_,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("card",{attrs:{title:t.__("Transactions")},scopedSlots:t._u([{key:"header",fn:function(){return[r("create-transaction",{attrs:{order:t.model}})]},proxy:!0}])},[t._v(" "),t.model.transactions.length?r("div",{staticClass:"table-responsive"},[r("table",{staticClass:"table table-hover has-filled-header mb-0"},[r("thead",[r("tr",[r("th",{attrs:{scope:"col"}},[t._v("\n                        "+t._s(t.__("Amount"))+"\n                        "),r("span",{staticClass:"badge badge-light text-uppercase"},[t._v(t._s(t.model.currency))])]),t._v(" "),r("th",{attrs:{scope:"col"}},[t._v(t._s(t.__("Driver")))]),t._v(" "),r("th",{attrs:{scope:"col"}},[t._v(t._s(t.__("Completed at")))]),t._v(" "),r("th",{attrs:{scope:"col"}})])]),t._v(" "),r("tbody",t._l(t.model.transactions,(function(e,s){return r("transaction",{key:s,attrs:{transaction:e},on:{delete:function(e){return t.remove(s)}}})})),1)])]):r("div",{staticClass:"alert alert-info mb-0"},[t._v("\n        "+t._s(t.__("There are no transactions yet."))+"\n    ")])])}),[],!1,null,null,null).exports,l={props:{order:{type:Object,required:!0}},methods:{total:function(t){return new Number(t).toFixed(2)}}},u={components:{OrderInfo:a,Transactions:c,ProductsTable:Object(n.a)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"table-responsive"},[r("table",{staticClass:"table table-hover has-filled-header mb-0"},[r("thead",[r("tr",[r("th",{attrs:{scope:"col"}},[t._v(t._s(t.__("Name")))]),t._v(" "),r("th",{attrs:{scope:"col"}},[t._v("\n                    "+t._s(t.__("Price"))+"\n                    "),r("span",{staticClass:"badge badge-light text-uppercase"},[t._v(t._s(t.order.currency))])]),t._v(" "),r("th",{attrs:{scope:"col"}},[t._v("\n                    "+t._s(t.__("Tax"))+"\n                    "),r("span",{staticClass:"badge badge-light text-uppercase"},[t._v(t._s(t.order.currency))])]),t._v(" "),r("th",{attrs:{scope:"col"}},[t._v(t._s(t.__("Qty")))]),t._v(" "),r("th",{attrs:{scope:"col"}},[t._v("\n                    "+t._s(t.__("Total"))+"\n                    "),r("span",{staticClass:"badge badge-light text-uppercase"},[t._v(t._s(t.order.currency))])])])]),t._v(" "),r("tbody",t._l(t.order.products,(function(e,s){return r("tr",{key:s},[r("td",[t._v(t._s(e.name))]),t._v(" "),r("td",[t._v(t._s(e.item.price))]),t._v(" "),r("td",[t._v(t._s(e.item.tax))]),t._v(" "),r("td",[t._v(t._s(e.item.quantity))]),t._v(" "),r("td",[t._v(t._s(t.total(e.item.total)))])])})),0)])])}),[],!1,null,null,null).exports},data:function(){return{title:this.__("Order #:id",{id:this.$page.order.id})}}},p=Object(n.a)(u,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("data-form",{attrs:{action:t.$page.action,model:t.$page.order},scopedSlots:t._u([{key:"default",fn:function(){return[r("card",{staticClass:"mb-5",attrs:{title:t.__("General")}},[r("order-info",{attrs:{order:t.$page.order}})],1),t._v(" "),r("card",{attrs:{title:t.__("Products")}},[t.$page.order.products.length?r("products-table",{attrs:{order:t.$page.order}}):r("div",{staticClass:"alert alert-info  mb-0"},[t._v("\n                    "+t._s(t.__("There are no products yet."))+"\n                ")])],1)]},proxy:!0},{key:"aside",fn:function(e){return[r("card",{staticClass:"mb-5",attrs:{title:t.__("Settings")}},[r("form-select",{attrs:{name:"status",label:t.__("Status"),options:t.$page.statuses},model:{value:e.fields.status,callback:function(r){t.$set(e.fields,"status",r)},expression:"form.fields.status"}})],1)]}}])}),t._v(" "),r("div",{staticClass:"row"},[r("div",{staticClass:"col-12 col-lg-7 col-xl-8 mt-5"},[r("transactions",{attrs:{order:t.$page.order}})],1)])],1)}),[],!1,null,null,null);e.default=p.exports}}]);
//# sourceMappingURL=11.js.map